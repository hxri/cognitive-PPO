C:\Users\hxri\miniconda3\envs\cogppo\Lib\site-packages\gymnasium\envs\registration.py:523: DeprecationWarning: [33mWARN: The environment MiniGrid-Dynamic-Obstacles-Random-10x10-v0 is out of date. You should consider upgrading to version `v2`.
  logger.deprecation(
D:\Masters\Projects\thesis\cognitive-PPO\playground_gridworld_appraisal.py:303: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  next_appraisal = torch.tensor(agent.get_appraisal(next_obs).unsqueeze(1))
D:\Masters\Projects\thesis\cognitive-PPO\playground_gridworld_appraisal.py:105: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  napp = torch.tensor(certainity(logits).unsqueeze(1))
D:\Masters\Projects\thesis\cognitive-PPO\playground_gridworld_appraisal.py:96: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  napp = torch.tensor(certainity(cr).unsqueeze(1))
global_step=4, episodic_return=[-1.]
Moviepy - Building video D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-0.mp4.
Moviepy - Writing video D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-0.mp4
Moviepy - Done !
Moviepy - video ready D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-0.mp4
global_step=48, episodic_return=[-1.]
global_step=60, episodic_return=[-1.]
global_step=84, episodic_return=[-1.]
global_step=120, episodic_return=[-1.]
global_step=132, episodic_return=[-1.]
global_step=144, episodic_return=[-1.]
global_step=160, episodic_return=[-1.]
global_step=200, episodic_return=[-1.]
global_step=208, episodic_return=[-1.]
global_step=212, episodic_return=[-1.]
global_step=220, episodic_return=[-1.]
global_step=256, episodic_return=[-1.]
global_step=264, episodic_return=[-1.]
global_step=296, episodic_return=[0.99928]
global_step=304, episodic_return=[-1.]
global_step=328, episodic_return=[-1.]
global_step=340, episodic_return=[-1.]
global_step=376, episodic_return=[-1.]
global_step=396, episodic_return=[-1.]
global_step=420, episodic_return=[-1.]
global_step=424, episodic_return=[-1.]
global_step=456, episodic_return=[-1.]
global_step=480, episodic_return=[-1.]
global_step=500, episodic_return=[-1.]
SPS:  87
global_step=548, episodic_return=[-1.]
global_step=564, episodic_return=[-1.]
global_step=612, episodic_return=[-1.]
global_step=644, episodic_return=[-1.]
global_step=660, episodic_return=[-1.]
global_step=668, episodic_return=[-1.]
global_step=764, episodic_return=[-1.]
global_step=788, episodic_return=[-1.]
global_step=828, episodic_return=[-1.]
global_step=836, episodic_return=[-1.]
global_step=852, episodic_return=[-1.]
global_step=856, episodic_return=[-1.]
global_step=864, episodic_return=[-1.]
global_step=880, episodic_return=[-1.]
global_step=896, episodic_return=[-1.]
global_step=944, episodic_return=[-1.]
global_step=972, episodic_return=[-1.]
global_step=1020, episodic_return=[-1.]
SPS:  106
Moviepy - Building video D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-10.mp4.
Moviepy - Writing video D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-10.mp4
Moviepy - Done !
Moviepy - video ready D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-10.mp4
global_step=1036, episodic_return=[-1.]
global_step=1056, episodic_return=[-1.]
global_step=1148, episodic_return=[-1.]
global_step=1164, episodic_return=[-1.]
global_step=1188, episodic_return=[-1.]
global_step=1236, episodic_return=[-1.]
global_step=1312, episodic_return=[-1.]
global_step=1324, episodic_return=[-1.]
global_step=1356, episodic_return=[-1.]
global_step=1360, episodic_return=[-1.]
global_step=1380, episodic_return=[-1.]
global_step=1396, episodic_return=[-1.]
global_step=1424, episodic_return=[-1.]
global_step=1428, episodic_return=[-1.]
global_step=1432, episodic_return=[-1.]
global_step=1468, episodic_return=[-1.]
global_step=1480, episodic_return=[-1.]
global_step=1484, episodic_return=[0.99883]
global_step=1528, episodic_return=[-1.]
global_step=1536, episodic_return=[-1.]
SPS:  111
global_step=1564, episodic_return=[-1.]
global_step=1592, episodic_return=[-1.]
global_step=1716, episodic_return=[-1.]
global_step=1784, episodic_return=[-1.]
global_step=1796, episodic_return=[-1.]
global_step=1896, episodic_return=[-1.]
global_step=1964, episodic_return=[-1.]
global_step=1968, episodic_return=[-1.]
global_step=2032, episodic_return=[-1.]
SPS:  104
global_step=2136, episodic_return=[-1.]
global_step=2208, episodic_return=[-1.]
global_step=2348, episodic_return=[-1.]
global_step=2396, episodic_return=[-1.]
global_step=2464, episodic_return=[-1.]
global_step=2488, episodic_return=[-1.]
SPS:  112
global_step=2616, episodic_return=[-1.]
Moviepy - Building video D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-20.mp4.
Moviepy - Writing video D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-20.mp4
Moviepy - Done !
Moviepy - video ready D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-20.mp4
global_step=2624, episodic_return=[-1.]
global_step=2736, episodic_return=[-1.]
global_step=2792, episodic_return=[-1.]
global_step=2836, episodic_return=[-1.]
global_step=3000, episodic_return=[-1.]
SPS:  113
global_step=3088, episodic_return=[-1.]
global_step=3436, episodic_return=[-1.]
SPS:  119
SPS:  124
SPS:  114
global_step=4652, episodic_return=[-1.]
global_step=4856, episodic_return=[-1.]
SPS:  108
SPS:  108
global_step=5728, episodic_return=[-1.]
global_step=5824, episodic_return=[-1.]
global_step=6068, episodic_return=[-1.]
SPS:  109
SPS:  109
SPS:  110
SPS:  109
global_step=7688, episodic_return=[-1.]
SPS:  110
global_step=8452, episodic_return=[-1.]
SPS:  112
SPS:  113
global_step=9648, episodic_return=[-1.]
SPS:  115
SPS:  114
global_step=10584, episodic_return=[-1.]
SPS:  113
SPS:  112
SPS:  112
SPS:  111
SPS:  111
SPS:  112
SPS:  113
SPS:  114
SPS:  115
global_step=14884, episodic_return=[-1.]
SPS:  116
SPS:  117
global_step=16008, episodic_return=[-1.]
SPS:  118
global_step=16860, episodic_return=[-1.]
SPS:  118
global_step=16976, episodic_return=[-1.]
global_step=17172, episodic_return=[-1.]
global_step=17236, episodic_return=[-1.]
SPS:  119
SPS:  119
SPS:  119
SPS:  120
global_step=19052, episodic_return=[0.95914]
global_step=19208, episodic_return=[-1.]
global_step=19264, episodic_return=[-1.]
global_step=19280, episodic_return=[-1.]
Moviepy - Building video D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-30.mp4.
Moviepy - Writing video D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-30.mp4
Moviepy - Done !
Moviepy - video ready D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-30.mp4
global_step=19392, episodic_return=[-1.]
global_step=19428, episodic_return=[-1.]
SPS:  120
global_step=19796, episodic_return=[-1.]
SPS:  121
global_step=20036, episodic_return=[0.97786]
global_step=20468, episodic_return=[-1.]
SPS:  121
SPS:  122
SPS:  121
global_step=21524, episodic_return=[-1.]
SPS:  121
SPS:  120
SPS:  120
SPS:  121
SPS:  121
global_step=24316, episodic_return=[-1.]
global_step=24464, episodic_return=[-1.]
SPS:  121
global_step=25032, episodic_return=[-1.]
SPS:  122
SPS:  122
SPS:  122
global_step=26516, episodic_return=[-1.]
SPS:  123
SPS:  122
global_step=27148, episodic_return=[-1.]
global_step=27360, episodic_return=[-1.]
SPS:  122
global_step=27968, episodic_return=[-1.]
global_step=28028, episodic_return=[-1.]
SPS:  122
SPS:  122
SPS:  122
SPS:  122
global_step=29780, episodic_return=[-1.]
SPS:  123
global_step=30512, episodic_return=[-1.]
SPS:  123
global_step=30748, episodic_return=[-1.]
global_step=30780, episodic_return=[-1.]
SPS:  123
global_step=31280, episodic_return=[-1.]
global_step=31316, episodic_return=[-1.]
global_step=31348, episodic_return=[-1.]
SPS:  123
global_step=32084, episodic_return=[-1.]
SPS:  123
SPS:  124
global_step=32876, episodic_return=[-1.]
global_step=33240, episodic_return=[-1.]
SPS:  124
global_step=33380, episodic_return=[-1.]
global_step=33688, episodic_return=[-1.]
SPS:  124
global_step=34248, episodic_return=[-1.]
SPS:  124
global_step=34364, episodic_return=[-1.]
global_step=34692, episodic_return=[-1.]
SPS:  124
global_step=34948, episodic_return=[-1.]
global_step=35020, episodic_return=[-1.]
global_step=35048, episodic_return=[-1.]
SPS:  124
SPS:  124
global_step=36128, episodic_return=[-1.]
global_step=36172, episodic_return=[-1.]
SPS:  124
SPS:  124
t:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š                                                 | 292/575 [00:00<00:00, 310.70it/s, now=None]
Moviepy - Building video D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-40.mp4.

Moviepy - Done !
Moviepy - video ready D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-40.mp4
global_step=37308, episodic_return=[-1.]
SPS:  123
SPS:  124
global_step=38256, episodic_return=[-1.]
SPS:  124
SPS:  124
global_step=38956, episodic_return=[-1.]
SPS:  124
SPS:  124
global_step=40388, episodic_return=[-1.]
global_step=40396, episodic_return=[-1.]
global_step=40404, episodic_return=[-1.]
SPS:  124
global_step=40464, episodic_return=[-1.]
global_step=40692, episodic_return=[-1.]
global_step=40708, episodic_return=[-1.]
global_step=40912, episodic_return=[-1.]
SPS:  124
global_step=41372, episodic_return=[-1.]
SPS:  124
global_step=41596, episodic_return=[-1.]
SPS:  124
global_step=42296, episodic_return=[-1.]
SPS:  124
SPS:  124
SPS:  125
global_step=43564, episodic_return=[-1.]
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  126
global_step=47792, episodic_return=[-1.]
global_step=47800, episodic_return=[-1.]
SPS:  126
SPS:  126
global_step=48760, episodic_return=[-1.]
global_step=48916, episodic_return=[-1.]
SPS:  126
SPS:  126
global_step=50168, episodic_return=[-1.]
SPS:  127
global_step=50560, episodic_return=[-1.]
SPS:  127
SPS:  127
global_step=51496, episodic_return=[-1.]
SPS:  127
SPS:  127
SPS:  127
global_step=52844, episodic_return=[-1.]
SPS:  127
global_step=53744, episodic_return=[-1.]
SPS:  127
global_step=54264, episodic_return=[-1.]
SPS:  127
SPS:  127
SPS:  127
SPS:  128
SPS:  128
SPS:  128
global_step=57164, episodic_return=[-1.]
SPS:  128
global_step=57616, episodic_return=[-1.]
SPS:  128
global_step=58160, episodic_return=[-1.]
SPS:  128
SPS:  128
SPS:  128
SPS:  128
SPS:  128
SPS:  128
SPS:  129
SPS:  129
SPS:  129
SPS:  129
SPS:  129
SPS:  129
SPS:  129
SPS:  129
SPS:  129
SPS:  129
global_step=66084, episodic_return=[-1.]
SPS:  129
SPS:  129
SPS:  129
SPS:  129
SPS:  129
SPS:  129
SPS:  129
SPS:  129
global_step=70464, episodic_return=[-1.]
SPS:  128
global_step=70676, episodic_return=[-1.]
SPS:  128
SPS:  128
global_step=72032, episodic_return=[-1.]
SPS:  128
SPS:  128
SPS:  128
SPS:  127
SPS:  127
SPS:  127
SPS:  127
SPS:  127
SPS:  127
SPS:  126
global_step=77104, episodic_return=[-1.]
SPS:  126
SPS:  126
SPS:  126
SPS:  126
SPS:  126
SPS:  126
global_step=80216, episodic_return=[-1.]
SPS:  126
global_step=80432, episodic_return=[-1.]
global_step=80540, episodic_return=[-1.]
SPS:  126
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
global_step=86956, episodic_return=[-1.]
global_step=87008, episodic_return=[-1.]
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
global_step=89148, episodic_return=[-1.]
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
global_step=98900, episodic_return=[-1.]
SPS:  125
SPS:  125
global_step=99956, episodic_return=[-1.]
SPS:  124
global_step=100596, episodic_return=[-1.]
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
global_step=110564, episodic_return=[0.76132]
SPS:  124
global_step=110676, episodic_return=[0.]
global_step=110980, episodic_return=[-1.]
SPS:  124
SPS:  124
SPS:  124
SPS:  124
global_step=112668, episodic_return=[-1.]
SPS:  124
SPS:  124
global_step=113820, episodic_return=[-1.]
SPS:  124
SPS:  124
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
global_step=122876, episodic_return=[-1.]
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
global_step=127184, episodic_return=[-1.]
SPS:  125
SPS:  125
SPS:  125
SPS:  125
global_step=129148, episodic_return=[0.]
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
global_step=137332, episodic_return=[-1.]
SPS:  125
SPS:  125
SPS:  125
SPS:  125
global_step=139488, episodic_return=[-1.]
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
global_step=142580, episodic_return=[-1.]
SPS:  125
SPS:  125
global_step=143416, episodic_return=[-1.]
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
SPS:  125
global_step=147672, episodic_return=[-1.]
SPS:  125
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
SPS:  124
global_step=154580, episodic_return=[-1.]
SPS:  124
SPS:  124
SPS:  124
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  123
SPS:  122
SPS:  122
SPS:  123
SPS:  122
SPS:  122
SPS:  122
SPS:  122
SPS:  122
SPS:  122
SPS:  122
SPS:  123
SPS:  123
SPS:  122
SPS:  122
SPS:  123
SPS:  123
t:   3%|â–ˆâ–ˆâ–ˆ                                                                                                | 244/7978 [00:00<00:26, 286.95it/s, now=None]
Moviepy - Building video D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-50.mp4.

















Moviepy - Done !
Moviepy - video ready D:\Masters\Projects\thesis\cognitive-PPO\videos\MiniGrid-Dynamic-Obstacles-Random-10x10-v0__playground_gridworld_appraisal__1__1683229345\rl-video-episode-50.mp4
global_step=175316, episodic_return=[-1.]
SPS:  120
SPS:  120
global_step=176584, episodic_return=[-1.]
SPS:  120
SPS:  120
SPS:  120
SPS:  120
global_step=178284, episodic_return=[-1.]
SPS:  120
SPS:  120
SPS:  120
SPS:  120
SPS:  120
SPS:  120
SPS:  121
SPS:  121
global_step=182580, episodic_return=[0.]
SPS:  121
SPS:  121
SPS:  121
global_step=183988, episodic_return=[-1.]
SPS:  121
SPS:  121
SPS:  121
SPS:  121
SPS:  121
SPS:  121
SPS:  121
SPS:  121
SPS:  121
SPS:  121
SPS:  121
SPS:  121
SPS:  121
SPS:  121
Traceback (most recent call last):
  File "D:\Masters\Projects\thesis\cognitive-PPO\playground_gridworld_appraisal.py", line 327, in <module>
    next_obs, reward, terminated, truncated, info = envs.step(action.cpu().numpy())
                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\hxri\miniconda3\envs\cogppo\Lib\site-packages\gymnasium\vector\vector_env.py", line 203, in step
    return self.step_wait()
           ^^^^^^^^^^^^^^^^
  File "C:\Users\hxri\miniconda3\envs\cogppo\Lib\site-packages\gymnasium\vector\sync_vector_env.py", line 149, in step_wait
    ) = env.step(action)
        ^^^^^^^^^^^^^^^^
  File "C:\Users\hxri\miniconda3\envs\cogppo\Lib\site-packages\gymnasium\wrappers\record_episode_statistics.py", line 89, in step
    ) = self.env.step(action)
        ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\hxri\miniconda3\envs\cogppo\Lib\site-packages\gymnasium\wrappers\order_enforcing.py", line 56, in step
    return self.env.step(action)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\hxri\miniconda3\envs\cogppo\Lib\site-packages\gymnasium\wrappers\env_checker.py", line 49, in step
    return self.env.step(action)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Masters\Projects\thesis\cognitive-PPO\minigrid\minigrid\envs\dynamicobstacles.py", line 141, in step
    self.grid.set(old_pos[0], old_pos[1], None)
KeyboardInterrupt
SPS:  121